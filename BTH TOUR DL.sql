create database QL_TDLuse QL_TDLset dateformat dmy-----------char ,nchar cho phep gag doi ,varchar ,nvarchar---------------format là trình bay bieu dien ko anh huong den gia trị----------------------trình bày ngày thang năm 5==5.000 , 5 (dvt),5 m2---------------Qui ước chung khi làm thực hành --------key varchar(5), string nvarchar(100),date , int create table DIEMTQ(	MaDTQ varchar(5) not null primary key, 	TenDTQ nvarchar(100) not null, 	Noidung nvarchar(100), 	Ynghia nvarchar(100) );create table TOUR(	MaTour varchar(5) not null primary key,	TenTour nvarchar(500) not null,	Songay int , 	Sodem  int );create table CT_THAMQUAN(	MaTour varchar(5) not null, 	MaDTQ varchar(5) not null, 	Thoigian int 	primary key (MaTour,MaDTQ)); ----------tạo nhanh 2 khóaalter table CT_THAMQUAN add constraint FK_TOUR foreign key (MaTour)references TOUR(MaTour);alter table CT_THAMQUAN add constraint FK_DTQ foreign key (MaDTQ)references DIEMTQ(MaDTQ);create table HOPDONG(	SoHD varchar(5) not null  primary key , 	NgaylapHD date , 	NoidungHD nvarchar(100) not null, 	SoNguoidi int , 	Noidon varchar(5), 	NgaydiHD date, 	MaTour varchar(5), -----> TOUR(Matour)	MaDoan varchar(5) );alter table HOPDONG add constraint FK_TOUR_HD foreign key (MaTour)references TOUR(MaTour);create table DOAN(	MaDoan varchar(5) not null primary key , 	HoTen nvarchar(100), 	Phai nvarchar(5), 	Ngaysinh date, 	Diachi nvarchar(100), 	Dienthoai varchar(12));alter table HOPDONG add constraint FK_HD_DOAN foreign key (MaDoan)references DOAN(MaDoan);create table DIEMDUNGCHAN(	MaDDC  varchar(5) not null  primary key , 	TenDDC nvarchar(100) , 	Thanhpho nvarchar(100) );create table LOTRINH(	MaNoiDi varchar(5) not null, 	MaNoiDen varchar(5) not nullprimary key(MaNoiDi,MaNoiDen));create table LOTRINH_TOUR(	MaTour varchar(5) not null, -----TOUR(Matour)	MaNoiDi  varchar(5) not null, --------LOTRINH(manoidi)	MaNoiDen  varchar(5) not null, ---------LOTRINH(manoiden)	SongayO int , 	SongaydicuaPT int , 	LoaiPhuongtien nvarchar(10),	LoaiKhachsan nvarchar(10) 	primary key (MaTour,MaNoiDi,MaNoiDen));alter table LOTRINH_TOUR add constraint FK_LT_TUOR foreign key (MaTour)references TOUR(MaTour);alter table LOTRINH_TOUR add constraint FK_LT_CTIET foreign key (MaNoiDi,MaNoiDen)references LOTRINH(MaNoiDi,MaNoiDen); ---->ket 2 khoa ngoai create table CHUYEN(	MaChuyen char(5) not null primary key , 	Tenchuyen nvarchar(100) not null , 	NgaydiCuaChuyen date , 	MaNVHDDL varchar(5) , ------------>	NHANVIENHDDL(MaNVHDDL)	MaTour varchar(5) );----->TOUR(MATUOR)alter table CHUYEN add constraint FK_CHUYEN_TUOR foreign key (MaTour)references TOUR(MaTour);create table HOPDONG_NV(	SoHD  varchar(5) not null primary key, 	MaNVHDDL varchar(5) not null, ------------>	NHANVIENHDDL(MaNVHDDL)//2 cot bt k theket voiw nhau	NoidungHD_NV nvarchar(100) );create table NHANVIENHDDL(MaNVHDDL varchar(5) not null primary key, TenNV nvarchar(100) , NgaysinhNV date , PhaiNV nvarchar(5) , DiachiNV nvarchar(100), DienthoaiNV varchar(12) );alter table HOPDONG_NV add constraint FK_DH_NV foreign key (MaNVHDDL)references NHANVIENHDDL(MaNVHDDL);alter table CHUYEN add constraint FK_CHUYEN_NV foreign key (MaNVHDDL)references NHANVIENHDDL(MaNVHDDL);--------------tao cac rang buoc ------song>0, ngay >0 ...--------------------ve so do -------------nhap du lieu : 1 truoc nhieu sau--1 DOAN,DIEMTQ,LOTRINH //// 1 KHOA---2 NHANVIENHDDL  ///////2 KHOA----3 TOUR  ////////4 KHOA -----4 CON LAI 1)	Hiển thị thông tin các hướng dẫn viên du lịch của công ty.select * from NHANVIENHDDL2)	Cho biết hiện tại công ty có những tour du lịch nào.select a.hoten, c.tentourfrom DOAN a , HOPDONG b, TOUR cwhere a.madoan = b.madoan and b.matour = c.matour3)	Liệt kê các tour có số ngày đi >= 3.select b.tentour , Songayfrom  TOUR bwhere   b.Songay > 34)	Liệt kê đầy đủ thông tin các điểm tham quan.select * from DIEMTQ5)	Liệt kê các tour mà có ghé qua điểm du lịch Nha Trang.select * from TOUR where tentour like '%Nha Trang%'6)	Tìm khách hàng tham dự nhiều chuyến đi nhất của công ty.select top 1 a.HoTen , count(MaNoiDi)from DOAN a, HOPDONG b, LOTRINH_TOUR cwhere a.MaDoan=b.MaDoan and b.MaTour=c.MaTourgroup by a.HoTen7)	Liệt kê mã các đoàn khách và số lượng khách trong đoàn mà đã đăng ký tại đại lý do ‘Nguyễn Văn A’ làm đại diện trong năm 2010.select b.madoan ,b.songuoidifrom DOAN a, HOPDONG bwhere a.madoan=b.madoan and a.hoten =N'Nguyễn Văn A' and year(ngaydihd)=20108)	Cho biết có bao nhiêu chuyến đi đến Nha Trang được mở trong năm 2010.select count(tenchuyen) sochuyendendennhatrangfrom CHUYENwhere tenchuyen like'%Nha Trang'group by tenchuyen9)	Hiển thị thông tin những nhân viên nào đang đi tour (tính đến ngày 10/6/2010).select *from DOAN a , HOPDONG bwhere a.madoan =b.madoan and month(ngaydihd)=6 and year(ngaydihd) = 201010)	Hiển thị thông tin những những nhân viên nào đang rảnh trong ngày 10/6/2010.select a.TenNV from NHANVIENHDDL a,CHUYEN bwhere a.MaNVHDDL=b.MaNVHDDL and b.NgaydiCuaChuyen is not month(NgaydiCuaChuyen) =  6 and year(NgaydiCuaChuyen) = 201011)	Trong năm 2010, nhân viên nào đã lập hợp đồng cho khách du lịch theo đoàn nhiều nhất.select top 1 WITH ties a.tennv ,songuoidifrom NHANVIENHDDL a, HOPDONG_NV b, HOPDONG cwhere a.MaNVHDDL=b.MaNVHDDL and b.sohd=c.sohd order by  songuoidi desc12)	Cho biết tour du lịch nào sử dụng phương tiện ‘Ô tô’ nhiều nhất.select top 1 a.tentour , count(LoaiPhuongtien) LPTfrom TOUR a, LOTRINH_TOUR bwhere a.matour= b.matour and LoaiPhuongtien  = N'Ô tô'group by a.tentourorder by LPT desc13)	Hiển thị thông tin các tour mà toàn bộ lộ trình sử dụng phương tiện là ‘Ô tô’.--------select a.tentour ,a.matour from TOUR a, LOTRINH_TOUR bwhere a.matour= b.matour and LoaiPhuongtien  = N'Ô tô'14)	Cho biết thông tin của tour bán chạy nhất.select top 3 a.tentour , b.songuoidifrom TOUR a, HOPDONG bwhere a.MaTour = b.MaTour order by songuoidi desc15)	Hiển thị 3 tour du lịch có lộ trình qua hơn 4 điểm du lịch.select top 3 a.TenTourfrom TOUR a , where 16)	Hiển thị thông tin các tour đã đi (tính đến ngày 10/6/2010).select b.MaTour,b.TenTour, a.NgaydiHDfrom HOPDONG a, TOUR bwhere a.MaTour = b.MaTour and month(NgaydiHD)= 6 and year(NgaydiHD) = 201017)	Hiển thị thông tin các tour đang đi (tính đến ngày 10/6/2010).18)	Hiển thị thông tin các tour đang mở.19)	Liệt kê các điểm dừng chân ở thành phố Nha Trang.select *from DIEMDUNGCHANwhere	Thanhpho= 'Nha Trang'